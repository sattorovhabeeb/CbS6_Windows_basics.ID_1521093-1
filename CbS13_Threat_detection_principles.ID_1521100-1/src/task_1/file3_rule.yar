/*
    YARA Rule для детектирования file3.bin
    
    Описание: Это правило идентифицирует file3.bin по уникальному SHA256 хешу,
    текстовой строке и размеру файла
*/

rule Detect_File3_Bin
{
    meta:
        description = "Детектирует file3.bin по уникальному SHA256 хешу и размеру"
        author = "Security Analyst"
        date = "2026-01-03"
        reference = "file3.bin"
        
    strings:
        
        $hex_pattern = { 07 fb 69 57 99 f8 35 0e }
        
        $text_pattern = "size 1000027" nocase ascii
        
        // Уникальная часть SHA256 хеша для file3
        // Это средняя часть, которая отличает file3 от file1
        // (у них одинаковый размер, но разные хеши)
        $unique_hash = "f58c65e18738b75db042266b" ascii
        
    condition:
        // Для file3 используем ВСЕ три условия:
        
        // 1. Размер файла (третье обязательное условие из задания)
        // Обратите внимание: file1 тоже имеет размер 1000027,
        // но его отличит уникальный хеш
        filesize == 1000027
        
        // 2. Hex-паттерн (первое обязательное условие)
        and $hex_pattern
        
        // 3. Текстовая строка (второе обязательное условие)
        and $text_pattern
        
        // 4. Уникальная часть хеша для точной идентификации
        and $unique_hash
}